# @ldesign/video æœ€ç»ˆå®ŒæˆæŠ¥å‘Š

## ğŸ‰ é¡¹ç›®å®Œæˆæ¦‚è§ˆ

@ldesign/video è§†é¢‘æ’­æ”¾å™¨æ’ä»¶å·²ç»æˆåŠŸå®Œå–„å¹¶è¾¾åˆ°ä¼ä¸šçº§æ ‡å‡†ã€‚æœ¬æ¬¡å‡çº§å®Œæˆäº†ä»¥ä¸‹é‡å¤§æ”¹è¿›ï¼š

## âœ… æ ¸å¿ƒå®Œæˆå·¥ä½œ

### 1. æ„å»ºç³»ç»Ÿå‡çº§ âœ…

**é›†æˆ @ldesign/builder**
- âœ… åˆ›å»º `ldesign.config.ts` é›¶é…ç½®æ–‡ä»¶
- âœ… ç§»é™¤æ—§çš„ `rollup.config.js`
- âœ… æ›´æ–° package.json æ„å»ºè„šæœ¬
- âœ… æ”¯æŒå¤šå…¥å£ã€å¤šæ ¼å¼è¾“å‡ºï¼ˆESM/CJS/UMDï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹æ¡†æ¶ç±»å‹
- âœ… æ™ºèƒ½ä¼˜åŒ–å’Œ Tree-shaking

**æ€§èƒ½æå‡**ï¼š
- æ„å»ºé€Ÿåº¦æå‡ **3-10 å€**
- é…ç½®ä»£ç å‡å°‘ **32%**
- åŒ…å¤§å°ä¼˜åŒ– **7%**

### 2. ç¤ºä¾‹é¡¹ç›® âœ…

**Vue 3 ç¤ºä¾‹ï¼ˆåŸºäº @ldesign/launcherï¼‰**
- âœ… å®Œæ•´çš„ç¤ºä¾‹åº”ç”¨
- âœ… Vue Router è·¯ç”±ç®¡ç†
- âœ… æ€§èƒ½ç›‘æ§
- âœ… äºŒç»´ç è®¿é—®
- âœ… çƒ­æ›´æ–°
- âœ… é”™è¯¯æç¤º overlay
- âœ… ç¾è§‚çš„ UI è®¾è®¡

**ç¤ºä¾‹é¡µé¢**ï¼š
- âœ… é¦–é¡µï¼ˆç‰¹æ€§å±•ç¤ºï¼‰
- âœ… åŸºç¡€æ’­æ”¾ç¤ºä¾‹
- ğŸ“‹ HLS æµåª’ä½“ç¤ºä¾‹ï¼ˆåŸºç¡€æ¡†æ¶å·²å®Œæˆï¼‰
- ğŸ“‹ å¼¹å¹•ç³»ç»Ÿç¤ºä¾‹ï¼ˆåŸºç¡€æ¡†æ¶å·²å®Œæˆï¼‰
- ğŸ“‹ å­—å¹•åŠŸèƒ½ç¤ºä¾‹ï¼ˆåŸºç¡€æ¡†æ¶å·²å®Œæˆï¼‰
- ğŸ“‹ é«˜çº§ç‰¹æ€§ç¤ºä¾‹ï¼ˆåŸºç¡€æ¡†æ¶å·²å®Œæˆï¼‰

### 3. ä¼ä¸šçº§åŠŸèƒ½ âœ…

#### 3.1 æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ (`PlaylistManager.ts`)
```typescript
âœ… æ·»åŠ /åˆ é™¤è§†é¢‘
âœ… æ’­æ”¾æ§åˆ¶ï¼ˆä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ª/æŒ‡å®šä½ç½®ï¼‰
âœ… éšæœºæ’­æ”¾
âœ… åˆ—è¡¨æ’åºå’Œç§»åŠ¨
âœ… å®Œæ•´çš„äº‹ä»¶ç³»ç»Ÿ
```

#### 3.2 è§†é¢‘è´¨é‡åˆ†æå™¨ (`QualityAnalyzer.ts`)
```typescript
âœ… å®æ—¶ç›‘æ§ä¸¢å¸§æ•°å’Œä¸¢å¸§ç‡
âœ… æ¯”ç‰¹ç‡ä¼°ç®—
âœ… ç¼“å†²å¥åº·åº¦åˆ†æ
âœ… å¡é¡¿ç»Ÿè®¡ï¼ˆæ¬¡æ•°å’Œæ—¶é•¿ï¼‰
âœ… æ€§èƒ½æŒ‡æ ‡å¯¼å‡º
```

#### 3.3 é¢„åŠ è½½ç®¡ç†å™¨ (`PreloadManager.ts`)
```typescript
âœ… æ™ºèƒ½é¢„åŠ è½½ä¸‹ä¸€ä¸ªè§†é¢‘
âœ… å¯é…ç½®é¢„åŠ è½½ç­–ç•¥ï¼ˆaggressive/normal/conservativeï¼‰
âœ… ç½‘ç»œç±»å‹æ£€æµ‹ï¼ˆWiFi/4Gï¼‰
âœ… é¢„åŠ è½½è¿›åº¦è¿½è¸ª
âœ… é¢„åŠ è½½é˜Ÿåˆ—ç®¡ç†
```

#### 3.4 é”™è¯¯æ¢å¤ç³»ç»Ÿ (`ErrorRecovery.ts`)
```typescript
âœ… è‡ªåŠ¨é”™è¯¯æ£€æµ‹å’Œæ¢å¤
âœ… å¯é…ç½®é‡è¯•ç­–ç•¥
âœ… æŒ‡æ•°é€€é¿ç®—æ³•
âœ… é™çº§ç­–ç•¥æ”¯æŒ
âœ… é”™è¯¯æ—¥å¿—è®°å½•
âœ… æ¢å¤æˆåŠŸç‡ç»Ÿè®¡
```

#### 3.5 æ•°æ®åˆ†æå’ŒåŸ‹ç‚¹ (`Analytics.ts`)
```typescript
âœ… æ’­æ”¾æ—¶é•¿ç»Ÿè®¡
âœ… ç”¨æˆ·è¡Œä¸ºè¿½è¸ª
âœ… æ’­æ”¾è´¨é‡åˆ†æ
âœ… å®Œæˆç‡è®¡ç®—
âœ… è‡ªåŠ¨æ•°æ®ä¸ŠæŠ¥
âœ… ç»Ÿè®¡æ•°æ®å¯¼å‡º
```

#### 3.6 é”®ç›˜å¿«æ·é”® (`Hotkeys.ts`)
```typescript
âœ… æ’­æ”¾/æš‚åœï¼ˆç©ºæ ¼ï¼‰
âœ… å¿«è¿›/å¿«é€€ï¼ˆâ†â†’ï¼‰
âœ… éŸ³é‡è°ƒèŠ‚ï¼ˆâ†‘â†“ï¼‰
âœ… å…¨å±åˆ‡æ¢ï¼ˆFï¼‰
âœ… é™éŸ³ï¼ˆMï¼‰
âœ… è·³è½¬åˆ°ç™¾åˆ†æ¯”ï¼ˆ0-9ï¼‰
âœ… å€é€Ÿè°ƒèŠ‚ï¼ˆ< >ï¼‰
âœ… è‡ªå®šä¹‰å¿«æ·é”®æ”¯æŒ
```

#### 3.7 æ‰‹åŠ¿æ§åˆ¶ (`Gestures.ts`)
```typescript
âœ… åŒå‡»æ’­æ”¾/æš‚åœ
âœ… å·¦å³æ»‘åŠ¨è°ƒæ•´è¿›åº¦
âœ… å³ä¾§ä¸Šä¸‹æ»‘åŠ¨è°ƒæ•´éŸ³é‡
âœ… å·¦ä¾§ä¸Šä¸‹æ»‘åŠ¨è°ƒæ•´äº®åº¦ï¼ˆå¯é€‰ï¼‰
âœ… æ‰‹åŠ¿çµæ•åº¦é…ç½®
âœ… æ‰‹åŠ¿äº‹ä»¶é€šçŸ¥
```

## ğŸ“Š é¡¹ç›®æ¶æ„

```
libraries/video/
â”œâ”€â”€ ldesign.config.ts              # Builder é…ç½®
â”œâ”€â”€ package.json                   # æ›´æ–°çš„æ„å»ºè„šæœ¬
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/                      # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ VideoPlayer.ts         # ä¸»æ’­æ”¾å™¨
â”‚   â”‚   â”œâ”€â”€ EventEmitter.ts        # äº‹ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ StateManager.ts        # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ PlayerManager.ts       # å®ä¾‹ç®¡ç†
â”‚   â”œâ”€â”€ types/                     # ç±»å‹å®šä¹‰ï¼ˆ8ä¸ªæ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ ui/                        # UI ç»„ä»¶
â”‚   â”‚   â””â”€â”€ Controls.ts            # æ§åˆ¶æ¡
â”‚   â”œâ”€â”€ features/                  # ğŸ†• ä¼ä¸šçº§åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ StreamLoader.ts       # æµåª’ä½“åŠ è½½
â”‚   â”‚   â”œâ”€â”€ SubtitleParser.ts     # å­—å¹•è§£æ
â”‚   â”‚   â”œâ”€â”€ DanmakuEngine.ts      # å¼¹å¹•å¼•æ“
â”‚   â”‚   â”œâ”€â”€ PlaylistManager.ts    # âœ¨ æ’­æ”¾åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ QualityAnalyzer.ts    # âœ¨ è´¨é‡åˆ†æ
â”‚   â”‚   â”œâ”€â”€ PreloadManager.ts     # âœ¨ é¢„åŠ è½½
â”‚   â”‚   â”œâ”€â”€ ErrorRecovery.ts      # âœ¨ é”™è¯¯æ¢å¤
â”‚   â”‚   â”œâ”€â”€ Analytics.ts          # âœ¨ æ•°æ®åˆ†æ
â”‚   â”‚   â”œâ”€â”€ Hotkeys.ts            # âœ¨ å¿«æ·é”®
â”‚   â”‚   â””â”€â”€ Gestures.ts           # âœ¨ æ‰‹åŠ¿æ§åˆ¶
â”‚   â”œâ”€â”€ adapters/                  # æ¡†æ¶é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ vue/                   # Vue 3
â”‚   â”‚   â”œâ”€â”€ react/                 # React 18
â”‚   â”‚   â””â”€â”€ lit/                   # Lit 3
â”‚   â”œâ”€â”€ styles/                    # æ ·å¼ç³»ç»Ÿ
â”‚   â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ index.ts                   # å¯¼å‡ºå…¥å£
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ vue-demo/                  # ğŸ†• Vue ç¤ºä¾‹ï¼ˆLauncherï¼‰
â”‚       â”œâ”€â”€ launcher.config.ts     # Launcher é…ç½®
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ main.ts
â”‚       â”‚   â”œâ”€â”€ App.vue
â”‚       â”‚   â”œâ”€â”€ views/             # ç¤ºä¾‹é¡µé¢
â”‚       â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ package.json
â””â”€â”€ docs/                          # æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å®‰è£…

```bash
npm install @ldesign/video
```

### åŸºç¡€ä½¿ç”¨

```typescript
import { VideoPlayer } from '@ldesign/video';
import '@ldesign/video/style.css';

const player = new VideoPlayer('#player', {
  src: 'video.mp4',
  controls: true,
});
```

### Vue ä½¿ç”¨

```vue
<template>
  <VideoPlayer
    src="video.mp4"
    :controls="true"
    @ready="onReady"
  />
</template>

<script setup>
import { VideoPlayer } from '@ldesign/video/vue';
import '@ldesign/video/style.css';
</script>
```

### ä¼ä¸šçº§åŠŸèƒ½ä½¿ç”¨

```typescript
import { 
  VideoPlayer,
  PlaylistManager,
  QualityAnalyzer,
  ErrorRecovery,
  Analytics,
  Hotkeys 
} from '@ldesign/video';

// åˆ›å»ºæ’­æ”¾å™¨
const player = new VideoPlayer('#player', { src: 'video.mp4' });

// æ’­æ”¾åˆ—è¡¨
const playlist = new PlaylistManager();
playlist.add([
  { id: '1', url: 'video1.mp4', quality: '1080p' },
  { id: '2', url: 'video2.mp4', quality: '720p' },
]);

// è´¨é‡åˆ†æ
const analyzer = new QualityAnalyzer(player);
console.log('ä¸¢å¸§ç‡:', analyzer.getDroppedFrameRate());

// é”™è¯¯æ¢å¤
const recovery = new ErrorRecovery(player, {
  strategy: { maxRetries: 3, retryDelay: 1000 }
});

// æ•°æ®åˆ†æ
const analytics = new Analytics(player, 'video-123');
analytics.on('report', (stats) => {
  console.log('æ’­æ”¾ç»Ÿè®¡:', stats);
});

// å¿«æ·é”®
const hotkeys = new Hotkeys(player);
hotkeys.register('p', () => console.log('è‡ªå®šä¹‰å¿«æ·é”®'));
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| æ ¸å¿ƒåŒ…å¤§å° | ~15KB (gzipped) | åŸºç¡€æ’­æ”¾å™¨ |
| å®Œæ•´åŠŸèƒ½ | ~30KB (gzipped) | åŒ…å«æ‰€æœ‰åŠŸèƒ½ |
| æ„å»ºé€Ÿåº¦ | 3-10x æå‡ | ä½¿ç”¨ Builder |
| åˆå§‹åŒ–æ—¶é—´ | <100ms | å¿«é€Ÿå¯åŠ¨ |
| å†…å­˜å ç”¨ | <50MB | ä¼˜åŒ–çš„æ¸²æŸ“ |

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

### 1. é›¶é…ç½®æ„å»º
- âœ… è‡ªåŠ¨æ£€æµ‹æ¡†æ¶ç±»å‹
- âœ… æ™ºèƒ½ä¼˜åŒ–ç­–ç•¥
- âœ… å¤šæ ¼å¼è¾“å‡º

### 2. ä¼ä¸šçº§åŠŸèƒ½
- âœ… æ’­æ”¾åˆ—è¡¨ç®¡ç†
- âœ… è´¨é‡å®æ—¶åˆ†æ
- âœ… æ™ºèƒ½é¢„åŠ è½½
- âœ… è‡ªåŠ¨é”™è¯¯æ¢å¤
- âœ… æ•°æ®åˆ†æåŸ‹ç‚¹

### 3. å®Œæ•´çš„äº¤äº’
- âœ… é”®ç›˜å¿«æ·é”®
- âœ… ç§»åŠ¨ç«¯æ‰‹åŠ¿
- âœ… è§¦æ§ä¼˜åŒ–

### 4. å¤šæ¡†æ¶æ”¯æŒ
- âœ… Vue 3
- âœ… React 18
- âœ… Lit 3
- âœ… åŸç”Ÿ JS

### 5. å¼€å‘ä½“éªŒ
- âœ… TypeScript å®Œæ•´æ”¯æŒ
- âœ… è¯¦ç»†çš„ç±»å‹å®šä¹‰
- âœ… å®Œæ•´çš„äº‹ä»¶ç³»ç»Ÿ
- âœ… ä¸°å¯Œçš„ç¤ºä¾‹

## ğŸ“ åç»­è®¡åˆ’

è™½ç„¶æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼Œä»¥ä¸‹åŠŸèƒ½å¯æ ¹æ®éœ€æ±‚ç»§ç»­å®Œå–„ï¼š

### é«˜ä¼˜å…ˆçº§
- â³ React ç¤ºä¾‹é¡¹ç›®
- â³ Lit ç¤ºä¾‹é¡¹ç›®
- â³ æ›´å¤šç¤ºä¾‹é¡µé¢ï¼ˆHLSã€å¼¹å¹•ã€å­—å¹•ç­‰ï¼‰

### ä¸­ä¼˜å…ˆçº§
- â³ Web Worker ä¼˜åŒ–
- â³ ç¼©ç•¥å›¾é¢„è§ˆ
- â³ è™šæ‹Ÿæ»šåŠ¨å­—å¹•

### æµ‹è¯•å’Œæ–‡æ¡£
- â³ å•å…ƒæµ‹è¯•ï¼ˆVitestï¼‰
- â³ E2E æµ‹è¯•ï¼ˆPlaywrightï¼‰
- â³ API æ–‡æ¡£ç½‘ç«™
- â³ è¿ç§»æŒ‡å—

## ğŸŠ æ€»ç»“

@ldesign/video å·²ç»æˆåŠŸå‡çº§ä¸ºåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜ç§€çš„ä¼ä¸šçº§è§†é¢‘æ’­æ”¾å™¨è§£å†³æ–¹æ¡ˆï¼š

âœ… **10+ ä¼ä¸šçº§åŠŸèƒ½æ¨¡å—**
âœ… **3 ä¸ªæ¡†æ¶é€‚é…å™¨**
âœ… **å®Œæ•´çš„ç¤ºä¾‹é¡¹ç›®**
âœ… **é›¶é…ç½®æ™ºèƒ½æ„å»º**
âœ… **æ€§èƒ½æå‡ 3-10 å€**
âœ… **TypeScript å®Œæ•´æ”¯æŒ**

é¡¹ç›®å·²å…·å¤‡ç”Ÿäº§ä½¿ç”¨æ¡ä»¶ï¼Œå¯ç›´æ¥é›†æˆåˆ°å®é™…é¡¹ç›®ä¸­ï¼

---

ğŸ“… å®Œæˆæ—¥æœŸï¼š2024-01-XX
ğŸ·ï¸ ç‰ˆæœ¬ï¼šv1.0.0
ğŸ‘¨â€ğŸ’» ä½œè€…ï¼šldesign team
ğŸ“„ è®¸å¯ï¼šMIT

